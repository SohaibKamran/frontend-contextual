<div class="modal-header border-0 pb-0 px-5" id="episode-preview-video-player">
  <div class="d-flex align-items-center">
    <i class="bi bi-play-btn me-2 text-gray fs-xxl"></i>
    <h5 class="modal-title mb-0" id="exampleModalLiveLabel">
      Episode Preview
    </h5>
  </div>
  <button type="button" class="btn-close text-muted" data-bs-dismiss="modal" aria-label="Close" (click)="closeModal()">
  </button>
</div>
<div class="text-center">
  <div *ngIf="episodeLoader" class="spinner-border text-primary mx-auto" role="status">
  </div>
</div>
<div *ngIf="allScenes.length>0 && episodeLoader==false" class="modal-body pt-0 px-5">
  <div class="row mb-3 align-items-center">
    <div class="col-lg-5 episode-detail">
      <div class="img-wrapper d-flex align-items-center">
        <img src="{{episodePreviewDetails?.thumbnail}}">

        <div>
          <h6 class="fs-xl fw-semibold mb-1">{{episodePreviewDetails?.Series?.title}}</h6>
          <p class="text-muted fs-lg mb-0">Season {{episodePreviewDetails?.seasonNo}} Episode
            {{episodePreviewDetails?.episodeNo}}
          </p>
        </div>
      </div>
    </div>
    <div class="col-lg-7 episode-preview">

      <app-vjs-player *ngIf="episodePreviewDetails?.videoUrl" [hidden]="hideVideo"
        [options]="{autoplay: true, controls: true, sources: [{ src: episodePreviewDetails?.videoUrl,type:'video/mp4' }],controlBar:{skipButtons:{forward:5,backward:5}},title:'My Video'}"
        (newItemEvent)="pauseVideo($event)" (playEvent)="playVideo($event)" [showAdds]="showAdds"
        (toggleFullScreen)="toggleFullScreen($event)" [successMessage]="showWishlistSuccess"
        [currentEpisode]="episodePreviewDetails" [series]="episodePreviewDetails.Series"
        [sceneProductsData]="sceneProductsData" [pauseOnLoad]="!autoPlay" [sceneNumber]="currentPage" [verticalAds]="true">
        <!-- <cdk-ads-slider (showAddToWishlistPopup)="showAddToWishlistPopup($event)" [currentEpisode]="episodePreviewDetails"
          [sceneProductsData]="sceneProductsData" [isFullScreen]="isFullScreen" [isPlaying]="isPlaying"
          [showAdds]="showAdds" [addsToShow]="addsFetched">
        </cdk-ads-slider> -->
      </app-vjs-player>
      <!-- <section class="wrap-video">
        <vg-player id="wrap-video" (onPlayerReady)="onPlayerReady($event)">

          <vg-buffering></vg-buffering>

          <vg-scrub-bar [ngStyle]="showAdds ? {'width':'calc(80% - 80px)'}:{'width':'calc(100% - 80px)'}" class="mb-5">
            <vg-time-display vgProperty="current" vgFormat="mm:ss" style="position: absolute; bottom: 0;">
            </vg-time-display>

            <vg-scrub-bar-current-time vgFor="mediaPlayed" [vgSlider]="true"></vg-scrub-bar-current-time>
            <vg-scrub-bar-buffering-time vgFor="mediaPlayed"></vg-scrub-bar-buffering-time>

          </vg-scrub-bar>

          <vg-controls [ngStyle]="showAdds ? {'width':'80%'}:{'width':'100%'}"
            class="d-flex align-items-center vg_controls" style="background-color: transparent !important;">


            <div class="volume-icon align-items-center d-flex volume-icon">

              <img id="toggle-animation" *ngIf="this.api.volume > 0" (click)="toggleSound('mute')"
                src="../../assets//icons/volume.svg" class="cursor img-icon-s">

              <img id="toggle-animation" *ngIf="this.api.volume === 0" (click)="toggleSound('unmute')"
                src="../../assets//icons/volume-mute.svg" class="cursor img-icon-s">

              <input (input)="adjustVolume($event.target)" step="0.2" min="0" max="1" type="range" class="form-range">

            </div>




            <div class="d-flex mx-auto align-items-center">

              <div>
                <img src="../../assets//icons/refresh-ccw-01.svg" class="cursor img-icon"
                  *ngIf="api.getDefaultMedia()?.isCompleted === false" (click)="rewindVideo()">
              </div>


              <div class="mx-4">

                <i class="bi bi-pause-fill pause cursor"
                  *ngIf="isPlaying && api.getDefaultMedia()?.isCompleted === false" (click)="pauseVideo()"></i>
               
                <i class="bi bi-play-fill cursor play"
                  *ngIf="!isPlaying && api.getDefaultMedia()?.isCompleted === false" (click)="playVideo()"></i>


                <i class="bi bi-arrow-clockwise cursor play" *ngIf="api.getDefaultMedia()?.isCompleted === true"
                  (click)="rePlayVideo()"></i>


              </div>

              <div>

                <img src="../../assets//icons/refresh-cw-01.svg" class="cursor img-icon"
                  *ngIf="api.getDefaultMedia()?.isCompleted === false" (click)="forwardVideo()">

              </div>

              <div class="align-items-center d-flex">
                <span class="d-block d-md-none fs-3 icon-target me-3 text-white advertisor-icon"
                  data-bs-target="#exampleModal6" data-bs-toggle="modal"></span>
                <img (click)="toggleFullScreen()" src="../../assets/icons/fullscreen.svg"
                  class="cursor img-icon-s full-screen-icon d-none d-md-block">
              </div>


            </div>




          </vg-controls>


          <video #videoFileContainer src="{{episodePreviewDetails?.videoUrl}}" #media [vgMedia]="$any(media)"
            alt="media to stream" type="video/mp4" id="mediaPlayed" preload="auto" crossorigin>
          </video>

 

          <div style="position: absolute;left: 30px; top: 25px;" class="text-white">
            <div class="align-items-baseline d-flex">
              <i (click)="goBackToPrevPage()" class="bi bi-chevron-left d-block d-lg-none fs-xl fw-bold me-2 ml-15"></i>
              <div>
                <h6 class="fw-bold">
                  {{episodePreviewDetails?.title}}</h6>
                <div class="d-flex">
                  <p>S{{episodePreviewDetails?.seasonNo}} E{{episodePreviewDetails?.episodeNo}}</p>
                </div>
              </div>
            </div>
          </div>

          <div class="add-popup">
            <i class="bi bi-heart-fill text-heart mt-1"></i>
            <p class="mb-0 text-white ms-2">Saved to your Wishlist</p>
          </div>


          <section class="adds-section">
            <div *ngIf="!isPlaying && showAdds" id="add-list-scroll" class="text-center">
              <h6 class="text-light mb-0 text-center fw-normal pt-2 mb-2 product-radar">PRODUCT RADAR</h6>
              <div class="ad-list" id="add-products-scroll"
                *ngIf="currentSceneData?.ProxyCoordinates && currentSceneData?.ProxyCoordinates?.length !== 0">
                <div *ngFor="let item of currentSceneData?.ProxyCoordinates">
                  <div *ngIf="item?.CoordinateHasProducts.length>0">
                    <div class="position-relative">
                      <img class="shopping"
                        src={{item?.CoordinateHasProducts?.[0]?.ProductImage?.reuploadedImages?.images?.[0]}} alt="">
                      <div class="ad-icon">
                        <i class="bi bi-badge-ad"></i>
                      </div>
                      <div class="d-flex justify-content-between align-items-center mb-2">
                        <p class="mb-0">{{item?.CoordinateHasProducts?.[0]?.Retailer?.name}}</p>
                        <img src="../../../assets/icons/heart-empty.svg" style="width: 12px;">
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </vg-player>
      </section> -->
    </div>
  </div>

  <div class="row" *ngIf="episodePreviewDetails?.videoUrl" [hidden]="hideVideo">
    <div class="col-lg-7 ms-auto">
      <div class="player-range mx-5">
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-auto">
      <div class="card-title fw-medium mb-2">
        Ad Served
      </div>
    </div>
    <div class="col-md ad-queue-ps">
      <div class="card-title fw-medium mb-2">
        Ad Queue
      </div>
    </div>
  </div>
  <div *ngIf="episodeLoaderr" class="spinner-border text-primary mx-auto d-block" role="status">
  </div>
  <section class="add-section-scroll">
    <div *ngIf="!episodeLoaderr">
      <div class="row row-cols-3" *ngFor="let productQueue of adServedObjArray; let i=index">
        <div class="col-md-auto">
          <div class="overflow-ai mb-3">
            <div *ngIf="productQueue[0] && !productQueue[0].hide" class="proxy-product">
              <div class="product-img cursor">
                <img (click)="openAddToCartModal(productQueue[0].CoordinateHasProducts[0])" *ngIf="productQueue[0]?.CoordinateHasProducts[0]"
                  src={{productQueue[0]?.CoordinateHasProducts[0]?.matchedImageUrl}}>
              </div>
              <div class="d-flex align-items-center cursor">
                <span class="fs-sm text-gray ellipsis"
                  *ngIf="productQueue[0]?.CoordinateHasProducts[0]">{{productQueue[0]?.CoordinateHasProducts[0]?.Retailer?.name}}</span>
              </div>
              <span *ngIf="isDemo !== true" class="bi bi-x-lg icon-close text-light fs-md cursor"
                (click)="removeAd(productQueue[0]?.CoordinateHasProducts[0])"></span>
              <span class="badge text-bg-warning fw-bold badge-ad"
                *ngIf="productQueue[0]?.CoordinateHasProducts[0]">{{roundOffValues(productQueue[0]?.CoordinateHasProducts[0]?.vzotScore)}}</span>
            </div>
          </div>
        </div>
        <div class="col-md-auto my-auto">
          <button class="text-primary border-0 bg-white filtericon mb-3" (click)="openModal(i)"><i
              class="fas fa-sliders-h"></i></button>
        </div>
        <div class="col-md">
          <div class="d-flex align-items-center overflow-ai mb-3 overflow-auto">
            <div *ngFor="let item of productQueue[0]?.CoordinateHasProducts;let j=index">
              <div *ngIf="j>0 && ((item.afterSearch && item.show) || (!item.afterSearch)) && !item.hide" class="proxy-product me-2">
                <div class="product-img cursor">
                  <img (click)="openAddToCartModal(item)" src={{item?.matchedImageUrl}}>
                </div>
                <div class="d-flex align-items-center cursor">
                  <span class="fs-sm text-gray ellipsis">{{item?.Retailer?.name}}</span>
                </div>
                <span *ngIf="isDemo !== true" class="bi bi-x-lg icon-close text-light fs-md cursor"
                  (click)="removeAd(item)"></span>
                <span
                  class="badge fw-bold badge-ad border border-white text-bg-secondary">{{roundOffValues(item?.vzotScore)}}</span>
                <span class="icon-co fs-md text-light fs-lg"></span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="adServedObjArray?.length===0 && !episodeLoaderr">
      No Record Found
    </div>
  </section>
</div>
<div class="justify-content-between modal-footer bg-light-ai px-5">
  <button type="button" [disabled]="episodeLoader" (click)="closeModal()"
    class=" text-danger btn border-0 bg-transparent">Cancel</button>
  <button type="button" [disabled]="episodeLoader" class="btn btn-primary" (click)="update();closeModal()"> Update
  </button>
</div>